# Project 8 - Pentesting Live Targets

Time spent: 10.5 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

### Vulnerability #1: Session Hijacking

In this case, the session ID from the "victim" browser was transferred to the attcker's browser and then used as if he/she were the "victim" browser instead.
This was done by the given link to access the current session ID to then transfer over to the attacker's browser.

![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Blue-SessionHijacking.gif)

### Vulnerability #2: SQL Injection

From the salespersons list, we can inject a piece of SQL into the employee's ID. 
This SQL code will cause the browser to call the sleep method causing it to wait for 10 seconds. 
It can be further exploited by changing the hanging time to possibly allow the download of another malicious script that might take longer to load.

![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Blue-SQLInjection.gif)

## Green

### Vulnerability #1: Cross-Site Scripting (XSS) Alert Dialog Pop Up

Using the Feedback form, a simple script alert was sent as a comment to prove that other more complex scripts can possibly run on this site as well. 

![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Green-XSS-AlertDialog.gif)

### Vulnerability #2: Enumerating Users

In this case, the user known user "jmonroe99" was used with an incorrect password which resulted in a bolded, unsuccessful login message.
When an unknown or non-registered user was tested, the font remained as a regular font style instead of the bolded format in the previous case.
This implies that unregistered users get a regular font feedback & only known, registered users's accounts exist that can be exploited further with a bit of confirmation from the font changes.


![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Green-EnumerateUsers.gif)

## Red

### Vulnerability #1: Insecure Direct Object Reference (IDOR)

From the salespersons list, the ID parameter was left unprotected, vulnerable to IDOR attacks.
I was able to intercept the GET request into BURP and ran an intruder attack targetting the ID paramter using a number list from 1-50.
On the 10th and 11th iterations, it revealed two "employees" that did not appear on the public webpage.

![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Red-IDOR.gif)

Vulnerability #2: CSRF

The red website was vulnerable to CSRF attacks. By using a created submission form, I was able to send a POST request that altered the employee information including name, phone, email, etc.
This vulnerability can be very harmful for a company if someone decides to target and deface their website for any reason.

![](https://github.com/jsanc061/Unit09-Pentesting-Live-Targets/blob/master/vulnerabilities/Red-CSRF.gif)

## Notes

I was unable to get the CSRF vulnerability that should be somewhere in the RED website.
I was thinking to use a script inside the comments of the Feedback form that I thought would work but it failed and now I'm out of time.
This was definitely a fun challenge for me though. 

-- P.S. --

After the extension was given, I was successfully able to exploit the CSRF vulnerability by opening through the Firefox browser.

